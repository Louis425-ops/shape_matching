# 螺母检测项目编译流程

## 项目信息
- 项目路径: `/home/zby/Desktop/shape_based_matching`
- 输出文件: `nut_1`
- 编译时间: 2025-08-19 10:30

## 编译步骤

### 1. 清理旧的构建文件
```bash
rm -rf build
```
**结果**: 成功清理旧的构建目录

### 2. 检查依赖
```bash
# 检查OpenCV
pkg-config --cflags --libs opencv
```
**错误**: `Package opencv was not found`

```bash
# 尝试OpenCV4
pkg-config --cflags --libs opencv4
```
**成功**: 找到OpenCV4，返回编译参数:
```
-I/usr/include/opencv4 -lopencv_stitching -lopencv_alphamat -lopencv_aruco ... (完整库列表)
```

### 3. 第一次编译尝试
```bash
g++ -std=c++14 -O3 -I. $(pkg-config --cflags opencv4) nut_detection.cpp line2Dup.cpp -o nut_1 $(pkg-config --libs opencv4)
```
**错误**: 
```
fatal error: mipp.h: No such file or directory
```

### 4. 分析问题
通过`ls`命令检查项目结构，发现MIPP头文件位于`MIPP/`目录下。

### 5. 修正编译命令
```bash
g++ -std=c++14 -O3 -I. -IMIPP $(pkg-config --cflags opencv4) nut_detection.cpp line2Dup.cpp -o nut_1 $(pkg-config --libs opencv4)
```
**成功**: 编译完成，生成可执行文件

### 6. 验证结果
```bash
ls -la nut_1
```
**输出**: 
```
-rwxr-xr-x 1 zby zby 225416 Aug 19 10:30 nut_1
```

## 编译配置说明

### 编译器参数
- `-std=c++14`: 使用C++14标准
- `-O3`: 最高级别优化
- `-I.`: 包含当前目录头文件
- `-IMIPP`: 包含MIPP库头文件目录

### 依赖库
- **OpenCV4**: 计算机视觉库
  - 头文件路径: `/usr/include/opencv4`
  - 链接的主要库: opencv_core, opencv_imgproc, opencv_imgcodecs, opencv_highgui等

### 源文件
- `nut_detection.cpp`: 主程序文件（螺母检测功能）
- `line2Dup.cpp`: 形状匹配算法实现

## 遇到的问题及解决方案

### 问题1: CMake未安装
- **现象**: `cmake: command not found`
- **解决**: 改用g++直接编译

### 问题2: OpenCV包名
- **现象**: `Package opencv was not found`
- **解决**: 使用`opencv4`包名

### 问题3: MIPP头文件缺失
- **现象**: `fatal error: mipp.h: No such file or directory`
- **解决**: 添加`-IMIPP`参数包含MIPP目录

## 最终编译命令

```bash
g++ -std=c++14 -O3 -I. -IMIPP $(pkg-config --cflags opencv4) nut_detection.cpp line2Dup.cpp -o nut_1 $(pkg-config --libs opencv4)
```

## 项目特性
- 支持SIMD优化（通过MIPP库）
- 多模板投票检测功能
- 内置NMS（非极大值抑制）
- 支持旋转和缩放变换

编译成功！可执行文件 `nut_1` 已生成。